<!DOCTYPE html>
<html lang="zh-CN">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>DeWeb</title>
</head>

<body style="background-color:#F0F0F0">
<script src="dist/vue.js" type="text/javascript"></script>
<script src="dist/index.js" type="text/javascript"></script>
<script src="dist/axios.min.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="dist/theme-chalk/index.css" />

    <div id="app" style="position:absolute;overflow:hidden;left:0;right:0;bottom:0;margin: 0 auto;background-color:#FFFFFF" :style="{top:Form1_1__top,width:Form1_1__wid,height:Form1_1__hei}" >
        <el-dialog :title="input_query_caption" :visible.sync="input_query_visible" >
        	<el-form style="width:90%;padding-left:5%;">
        		<el-form-item :label="input_query_inputname" >
        			<el-input v-model="input_query_inputdefault" autocomplete="off"></el-input>
        		</el-form-item>
        	</el-form>
        	<div slot="footer" class="dialog-footer">
        		<el-button @click="input_query_visible=false">{{input_query_cancelcaption}}</el-button>
        		<el-button type="primary" @click="processinputquery">{{input_query_okcaption}}</el-button>
        	</div>
        </el-dialog>
		<iframe id="id_iframe" name="upload_iframe" style="display:none;"></iframe>
        <el-main v-if="Panel1__vis" :disabled="Panel1__dis" :style="{backgroundColor:Panel1__col,left:Panel1__lef,top:Panel1__top,width:Panel1__wid,height:Panel1__hei}" style="position:absolute;overflow:hidden;">
        <el-image :src="Image1__src" fit="none" v-if="Image1__vis" :disabled="Image1__dis" :style="{left:Image1__lef,top:Image1__top,width:Image1__wid,height:Image1__hei}" style="position:absolute;">
        </el-Image>
        <div  v-html="Label1__cap" v-if="Label1__vis" :disabled="Label1__dis" :style="{left:Label1__lef,top:Label1__top,width:Label1__wid,height:Label1__hei}" style="position:absolute;color:#547460;font-family:'微软雅黑';font-size:18pt;font-weight:normal;font-style:normal;text-decoration:none;line-height:54px;">{{Label1__cap}}
        </div>
        </el-main>
        <el-main v-if="Panel2__vis" :disabled="Panel2__dis" :style="{backgroundColor:Panel2__col,left:Panel2__lef,top:Panel2__top,width:Panel2__wid,height:Panel2__hei}" style="position:absolute;overflow:hidden;">
        <el-main v-if="Panel3__vis" :disabled="Panel3__dis" :style="{backgroundColor:Panel3__col,left:Panel3__lef,top:Panel3__top,width:Panel3__wid,height:Panel3__hei}" style="position:absolute;overflow:hidden;">
        </el-main>
        <el-tabs v-if="PageControl1__vis" :disabled="PageControl1__dis" v-model="PageControl1__apg" :tab-position="PageControl1__tps" type="border-card" :style="{left:PageControl1__lef,top:PageControl1__top,width:PageControl1__wid,height:PageControl1__hei}" style="position:absolute;" @tab-click="dwevent($event,'PageControl1','this.PageControl1__apg','onchange','4851378')">
            <el-tab-pane v-if="TabSheet1__tbv" :label="TabSheet1__cap" name="TabSheet1">
            </el-tab-pane>
            <el-tab-pane v-if="TabSheet2__tbv" :label="TabSheet2__cap" name="TabSheet2">
            </el-tab-pane>
            <el-tab-pane v-if="TabSheet3__tbv" :label="TabSheet3__cap" name="TabSheet3">
            </el-tab-pane>
            <el-tab-pane v-if="TabSheet4__tbv" :label="TabSheet4__cap" name="TabSheet4">
            </el-tab-pane>
        <div :style="{width:PageControl1__wid,height:PageControl1__hei}" style="position:absolute;left:0px;top:0px;">
        <el-main v-if="PageControl1__apg=='TabSheet1'" :disabled="TabSheet1__dis" :style="{left:TabSheet1__lef,top:TabSheet1__top,width:TabSheet1__wid,height:TabSheet1__hei}" style="position:absolute;overflow:hidden;">
        <el-main v-if="Panel4__vis" :disabled="Panel4__dis" :style="{backgroundColor:Panel4__col,left:Panel4__lef,top:Panel4__top,width:Panel4__wid,height:Panel4__hei}" style="position:absolute;overflow:hidden;">
        <div  v-html="Label2__cap" v-if="Label2__vis" :disabled="Label2__dis" :style="{left:Label2__lef,top:Label2__top,width:Label2__wid,height:Label2__hei}" style="position:absolute;color:#000000;font-family:'微软雅黑';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;">{{Label2__cap}}
        </div>
        <div  v-html="Label3__cap" v-if="Label3__vis" :disabled="Label3__dis" :style="{left:Label3__lef,top:Label3__top,width:Label3__wid,height:Label3__hei}" style="position:absolute;color:#000000;font-family:'微软雅黑';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;">{{Label3__cap}}
        </div>
        <div  v-html="Label4__cap" v-if="Label4__vis" :disabled="Label4__dis" :style="{left:Label4__lef,top:Label4__top,width:Label4__wid,height:Label4__hei}" style="position:absolute;color:#000000;font-family:'微软雅黑';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;">{{Label4__cap}}
        </div>
        <div  v-html="Label5__cap" v-if="Label5__vis" :disabled="Label5__dis" :style="{left:Label5__lef,top:Label5__top,width:Label5__wid,height:Label5__hei}" style="position:absolute;color:#000000;font-family:'微软雅黑';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;">{{Label5__cap}}
        </div>
        <el-input v-if="Edit1__vis" :disabled="Edit1__dis" v-model="Edit1__txt" placeholder="精确匹配" :style="{backgroundColor:Edit1__col,left:Edit1__lef,top:Edit1__top,width:Edit1__wid,height:Edit1__hei}" style="position:absolute;border-radius:4px;border:1px solid #DCDFE6;overflow: hidden;" @input="dwevent($event,'Edit1','escape(this.Edit1__txt)','onchange','4851378')">
        </el-input>
        <el-input v-if="Edit2__vis" :disabled="Edit2__dis" v-model="Edit2__txt" placeholder="精确匹配" :style="{backgroundColor:Edit2__col,left:Edit2__lef,top:Edit2__top,width:Edit2__wid,height:Edit2__hei}" style="position:absolute;border-radius:4px;border:1px solid #DCDFE6;overflow: hidden;" @input="dwevent($event,'Edit2','escape(this.Edit2__txt)','onchange','4851378')">
        </el-input>
        <el-input v-if="Edit4__vis" :disabled="Edit4__dis" v-model="Edit4__txt" placeholder="精确匹配" :style="{backgroundColor:Edit4__col,left:Edit4__lef,top:Edit4__top,width:Edit4__wid,height:Edit4__hei}" style="position:absolute;border-radius:4px;border:1px solid #DCDFE6;overflow: hidden;" @input="dwevent($event,'Edit4','escape(this.Edit4__txt)','onchange','4851378')">
        </el-input>
        <el-select v-model="ComboBox1__txt" v-if="ComboBox1__vis" :disabled="ComboBox1__dis" :style="{left:ComboBox1__lef,top:ComboBox1__top,width:ComboBox1__wid,height:ComboBox1__hei}" style="position:absolute;border:1px solid #DCDFF0;border-radius:2px;" @change="dwevent($event,'ComboBox1','this.ComboBox1__txt','onchange','4851378')">
            <el-option v-for="item in ComboBox1__its" :key="item.value" :label="item.value" :value="item.value"/>
        </el-select>
        <el-button size=small v-if="Button1__vis" :disabled="Button1__dis" :type="Button1__typ" :style="{left:Button1__lef,top:Button1__top,width:Button1__wid,height:Button1__hei}" style="position:absolute;">{{Button1__cap}}
        </el-button>
        </el-main>
        <div :style="{left:StringGrid1__lef,top:StringGrid1__top,width:StringGrid1__wid,height:StringGrid1__hei}" style="position:absolute;">
            <el-table :data="StringGrid1__ces" highlight-current-row :row-style="{height:'37px'}" :header-row-style="{height:'37px'}" :header-cell-style="{background:'#f5f7fA'}" ref="StringGrid1" stripe border v-if="StringGrid1__vis" :disabled="StringGrid1__dis" :height="StringGrid1__hei" style="width:100%" @row-click="dwevent($event,'StringGrid1','val.d0','onclick','4851378')">
                <el-table-column show-overflow-tooltip fixed v-if=false prop="d0" label="rowno" width="10"></el-table-column>
                <el-table-column fixed="left" show-overflow-tooltip prop="d1" :label="StringGrid1__col0" width="80"></el-table-column>
                <el-table-column show-overflow-tooltip prop="d2" :label="StringGrid1__col1" width="230"></el-table-column>
                <el-table-column show-overflow-tooltip prop="d3" :label="StringGrid1__col2" width="80"></el-table-column>
                <el-table-column show-overflow-tooltip prop="d4" :label="StringGrid1__col3" width="80"></el-table-column>
                <el-table-column show-overflow-tooltip prop="d5" :label="StringGrid1__col4" width="255"></el-table-column>
            </el-table>
        </div>
        </el-main>
        <el-main v-if="PageControl1__apg=='TabSheet2'" :disabled="TabSheet2__dis" :style="{left:TabSheet2__lef,top:TabSheet2__top,width:TabSheet2__wid,height:TabSheet2__hei}" style="position:absolute;overflow:hidden;">
        </el-main>
        <el-main v-if="PageControl1__apg=='TabSheet3'" :disabled="TabSheet3__dis" :style="{left:TabSheet3__lef,top:TabSheet3__top,width:TabSheet3__wid,height:TabSheet3__hei}" style="position:absolute;overflow:hidden;">
        </el-main>
        <el-main v-if="PageControl1__apg=='TabSheet4'" :disabled="TabSheet4__dis" :style="{left:TabSheet4__lef,top:TabSheet4__top,width:TabSheet4__wid,height:TabSheet4__hei}" style="position:absolute;overflow:hidden;">
        </el-main>
            </div>
        </el-tabs>
        </el-main>
        <el-menu :default-active="MainMenu__act" class="el-menu-demo" background-color="rgb(38,42,53)" text-color="#fff" active-text-color="#ffd04b" :style='{left:MainMenu__lef,top:MainMenu__top,width:MainMenu__wid,height:MainMenu__hei}' style="position:absolute;line-height:30px;" @select="dwevent($event,'MainMenu','val','onclick','4851378')">
        <el-menu-item index="0"><i class="el-icon-s-home"></i><span slot="title">机构信息管理</span></el-menu-item>
        <el-submenu index="1"><template slot="title">
        <i class="el-icon-pie-chart"></i>
        <span>体检报告管理</span></template>
        <el-menu-item index="1-0">报告查询</el-menu-item>
<el-menu-item index="1-1">报告导出</el-menu-item>

        </el-submenu>
        <el-menu-item index="2"><i class="el-icon-collection"></i><span slot="title">机构备案管理</span></el-menu-item>
        <el-menu-item index="3"><i class="el-icon-chat-dot-square"></i><span slot="title">职业病防治调查管理</span></el-menu-item>
        <el-submenu index="4"><template slot="title">
        <i class="el-icon-setting"></i>
        <span>系统管理</span></template>
        <el-menu-item index="4-0">数据备份</el-menu-item>
<el-menu-item index="4-1">数据恢复</el-menu-item>

        </el-submenu>
        
        </el-menu>
	 </div>
    <script>
       Vue.prototype.dwsetcookie = function (c_name, value, expiredays) {
            var exdate = new Date();
            exdate.setDate(exdate.getDate() + expiredays);
            document.cookie = c_name + "=" + escape(value) + ((expiredays == null) ? "" : ";expires=" + exdate.toGMTString()); 
       },
       Vue.prototype.dwgetcookie = function (name) {
            var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)"); 
            if(arr=document.cookie.match(reg))
                 return unescape(arr[2]); 
            else
                 return '';
       },
	    Vue.prototype.procResp = function (data){
		    resp = JSON.parse(decodeURIComponent(String(data))); 
		    if (resp.m === "update"){
		        eval(String(resp.o));
		    } else if (resp.m === "showform"){
		        document.open();document.write(String(resp.o));
		    }
	    } 
        new Vue(
			{
				el: '#app',
				data: function () {
					return {
					    Form1_1__top:"0px",
					    Form1_1__wid:"990px",
					    Form1_1__hei:"790px",
                        Image1__lef:"15px",
                        Image1__top:"3px",
                        Image1__wid:"58px",
                        Image1__hei:"54px",
                        Image1__vis:true,
                        Image1__dis:false,
                        Image1__src:"media/images/internet/1.jpg",
                        Label1__lef:"91px",
                        Label1__top:"3px",
                        Label1__wid:"498px",
                        Label1__hei:"54px",
                        Label1__vis:true,
                        Label1__dis:false,
                        Label1__cap:"南安省互联网+职业病防治与职业健康管理系统",
                        Panel1__lef:"0px",
                        Panel1__top:"0px",
                        Panel1__wid:"990px",
                        Panel1__hei:"60px",
                        Panel1__vis:true,
                        Panel1__dis:false,
                        Panel1__col:"RGB(255,255,255,1.0)",
                        Panel3__lef:"0px",
                        Panel3__top:"0px",
                        Panel3__wid:"250px",
                        Panel3__hei:"600px",
                        Panel3__vis:true,
                        Panel3__dis:false,
                        Panel3__col:"RGB(38,42,53,1.0)",
                        Label2__lef:"16px",
                        Label2__top:"18px",
                        Label2__wid:"60px",
                        Label2__hei:"20px",
                        Label2__vis:true,
                        Label2__dis:false,
                        Label2__cap:"身份证号",
                        Label3__lef:"16px",
                        Label3__top:"58px",
                        Label3__wid:"60px",
                        Label3__hei:"20px",
                        Label3__vis:true,
                        Label3__dis:false,
                        Label3__cap:"企业名称",
                        Label4__lef:"297px",
                        Label4__top:"18px",
                        Label4__wid:"30px",
                        Label4__hei:"20px",
                        Label4__vis:true,
                        Label4__dis:false,
                        Label4__cap:"性别",
                        Label5__lef:"448px",
                        Label5__top:"18px",
                        Label5__wid:"30px",
                        Label5__hei:"20px",
                        Label5__vis:true,
                        Label5__dis:false,
                        Label5__cap:"工种",
                        Edit1__lef:"80px",
                        Edit1__top:"16px",
                        Edit1__wid:"209px",
                        Edit1__hei:"28px",
                        Edit1__vis:true,
                        Edit1__dis:false,
                        Edit1__txt:"",
                        Edit1__col:"#FFFFFF",
                        Edit2__lef:"82px",
                        Edit2__top:"56px",
                        Edit2__wid:"210px",
                        Edit2__hei:"28px",
                        Edit2__vis:true,
                        Edit2__dis:false,
                        Edit2__txt:"",
                        Edit2__col:"#FFFFFF",
                        Edit4__lef:"498px",
                        Edit4__top:"16px",
                        Edit4__wid:"207px",
                        Edit4__hei:"28px",
                        Edit4__vis:true,
                        Edit4__dis:false,
                        Edit4__txt:"",
                        Edit4__col:"#FFFFFF",
                        ComboBox1__its:[{value:'男'},{value:'女'}],
                        ComboBox1__lef:"342px",
                        ComboBox1__top:"16px",
                        ComboBox1__wid:"84px",
                        ComboBox1__hei:"28px",
                        ComboBox1__vis:true,
                        ComboBox1__dis:false,
                        ComboBox1__txt:"请选择",
                        Button1__lef:"632px",
                        Button1__top:"58px",
                        Button1__wid:"75px",
                        Button1__hei:"31px",
                        Button1__vis:true,
                        Button1__dis:false,
                        Button1__cap:"查询",
                        Button1__typ:"primary",
                        Panel4__lef:"0px",
                        Panel4__top:"0px",
                        Panel4__wid:"732px",
                        Panel4__hei:"100px",
                        Panel4__vis:true,
                        Panel4__dis:false,
                        Panel4__col:"RGB(255,255,255,1.0)",
                        StringGrid1__lef:"3px",
                        StringGrid1__top:"119px",
                        StringGrid1__wid:"726px",
                        StringGrid1__hei:"436px",
                        StringGrid1__vis:true,
                        StringGrid1__dis:false,
                        StringGrid1__col0:"序号",
                        StringGrid1__col1:"公司名称",
                        StringGrid1__col2:"工号",
                        StringGrid1__col3:"人员姓名",
                        StringGrid1__col4:"身份证号",
                        StringGrid1__ces:[{"d0":'1',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''},{"d0":'2',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''},{"d0":'3',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''},{"d0":'4',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''},{"d0":'5',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''},{"d0":'6',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''},{"d0":'7',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''},{"d0":'8',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''},{"d0":'9',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''},{"d0":'10',"d1":'',"d2":'',"d3":'',"d4":'',"d5":''}],
                        TabSheet1__lef:"4px",
                        TabSheet1__top:"31px",
                        TabSheet1__wid:"732px",
                        TabSheet1__hei:"565px",
                        TabSheet1__vis:true,
                        TabSheet1__dis:false,
                        TabSheet1__cap:"首页",
                        TabSheet2__lef:"4px",
                        TabSheet2__top:"31px",
                        TabSheet2__wid:"732px",
                        TabSheet2__hei:"565px",
                        TabSheet2__vis:false,
                        TabSheet2__dis:false,
                        TabSheet2__cap:"报告查询",
                        TabSheet3__lef:"4px",
                        TabSheet3__top:"31px",
                        TabSheet3__wid:"732px",
                        TabSheet3__hei:"565px",
                        TabSheet3__vis:false,
                        TabSheet3__dis:false,
                        TabSheet3__cap:"报告导出",
                        TabSheet4__lef:"4px",
                        TabSheet4__top:"31px",
                        TabSheet4__wid:"732px",
                        TabSheet4__hei:"565px",
                        TabSheet4__vis:false,
                        TabSheet4__dis:false,
                        TabSheet4__cap:"机构信息",
                        PageControl1__lef:"250px",
                        PageControl1__top:"0px",
                        PageControl1__wid:"740px",
                        PageControl1__hei:"600px",
                        PageControl1__vis:true,
                        PageControl1__dis:false,
                        PageControl1__apg:"TabSheet1",
                        PageControl1__tps:"top",
                        TabSheet1__tbv:true,
                        TabSheet2__tbv:true,
                        TabSheet3__tbv:true,
                        TabSheet4__tbv:true,
                        Panel2__lef:"0px",
                        Panel2__top:"60px",
                        Panel2__wid:"990px",
                        Panel2__hei:"600px",
                        Panel2__vis:true,
                        Panel2__dis:false,
                        Panel2__col:"RGB(255,255,255,1.0)",
                        MainMenu__lef:"0px",
                        MainMenu__top:"60px",
                        MainMenu__wid:"250px",
                        MainMenu__hei:"500px",
                        MainMenu__act:"0",
					    input_query_visible:false,
					    input_query_caption:"Input Query",
					    input_query_inputname:"new",
					    input_query_cancelcaption:"Cancel",
					    input_query_okcaption:"OK",
					    input_query_inputdefault:"",
					    input_query_method:"processinputquery",
					    input_query_visible:false,
					    version__istrial:false,
					    clientid:4851378,
					    shuntflag:4015
                    }
                },
                mounted() {
                    let me=this;
                    let Form1_1hearttimer = window.setInterval(function() {
                        axios.get('{"m":"heart","i":4851378}',{headers:{shuntflag:4015}})
                        .then(resp =>{me.procResp(resp.data)})
                        .catch((error) =>{me.dwnotify("Info","Network is disconnected!");clearInterval(Form1_1hearttimer);});
                    }, 590000);
                },
				methods: {
                    ToWebsite (e,n) {
                        var aTag = document.createElement('a'); 
                        aTag.setAttribute('href', e);
                        aTag.setAttribute('target', n);
                        aTag.click();
                    },
                    dwInputClick (e) {
                        document.getElementById(e).click();
                    },
                    dwInputChange (e) {
                        this[e+"__cap"] = document.getElementById(e+"__inp").files[0].name;
                        var sget = '{"m":"event","i":4851378,"c":"'+e+'","e":"getfilename","v":"'+escape(document.getElementById(e+"__inp").files[0].name)+'"}';
                        axios.get(sget)
                    },
                    filterHandler(value, row, column) {
                        const property = column['property'];
                        return row[property] === value;
                    },
                    dwInputSubmit (ipname) {
                        let me=this;let formData = new FormData();
                        formData.append('file', document.getElementById(ipname+"__inp").files[0]);
                        let config = {headers: {'Content-Type': 'multipart/form-data'}}
                        axios.post('/upload', formData, config)
                        .then(function (res) {
                            var sget = '{"m":"event","i":4851378,"c":"'+ipname+'","e":"onenddock","v":"success"}';
                            axios.get(sget)
                            .then(resp =>{me.procResp(resp.data)});
                        })
                    },
                    dwInputSubmit0 (ipname) {
                        document.getElementById(ipname+"__frm").submit();
                    },
                    dwnotify(caption,text) {this.$notify.warning({ title: caption, message: text, duration: 0,showClose: false });},
                    dwevent(val,compname,compvalue,compevent,handle) {
                        var jo={};
                        jo.m="event";
                        jo.i=handle;
                        jo.c=compname;
                        jo.v=escape(eval(compvalue))
                        jo.e=compevent;
                        axios.get(JSON.stringify(jo),{headers:{shuntflag:4015}})
                        .then(resp =>{this.procResp(resp.data)});
                    },
                    processinputquery(val) {
                        this.input_query_visible = false;
                        axios.get('{"m":"interaction","i":4851378,"s":"inputquery","t":"'+this.input_query_method+'","v":"'+this.input_query_inputdefault+'"}',{headers:{shuntflag:4015}})
                        .then(resp =>{this.procResp(resp.data)});
                    },
                },
                beforeDestroy() {
                    clearInterval(hearttimer);
                }
            }
        ); 
    </script>
</body>
</html>
