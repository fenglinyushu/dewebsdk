#更新说明

#### 2025-01-20 

- 服务端 DeWebServer
	（1）优化了cookie的读写

- 控件
	（1）更新了一些仅D12的写法，兼容D10.4.2
        （2）移除了DBChecked/DBMemo等DB控件
 

- 例程
	（1）完善了dwCrudPanel模块
        （2）去掉了一些案例中uses中不存在的单元

#### 2025-01-01

- 服务端 DeWebServer
	（1）增加了公共模块支持，可以编写公共模块，构建生成dll到runtime\publics目录。DeWebServer启动后自动载入该目录中的所有模块，供其它模块调用。实现可参考“Source\publics\dwUnidac”和‘source\demos\unidac使用公共模块数据库“。使用公共模块模式支持开发者自主使用习惯的数据库控件，比如unidac
        （2）DeWebServer中procResp中增加了try/catch, 以防止返回的js代码错误，影响后续的执行
        （3）更新了DWSGuardor, 不再处理nginx
        （4）增加了自定义upload成功的触发控件的函数dwSetUploadTarget，用于指定上传时触发事件的控件

- 控件
	（1）dwtstringgrid__multi增加了强制高亮所在行，解决了quickcrud中不能高亮所在行的bug
        （2）为dwTPageControl增加了Font.size属性，以解决其内的Edit字体大小问题
        （3）完善了dwTButtonGroup__category, 增加了dwattr/dwstyle支持， 可设置滚动条
        （4）更新了dwTMemo, 支持onclick, 并且设置本控件更新值的设置为DoubleBuffered
        （5）增加了dwTPanel__scroll控件，用于垂直滚动面板
        （6）更新了dwTComboBox.dpr, 解决了原来改变值时触发4次Onchange的bug
        （7）增加了dwTMediaPlayer__xg，集成了抖音出品的西瓜播放器，支持解析MP4、HLS、FLV等格式
        （8）增加了dwTMemo__googleads，用于显示google广告
        （9）增加了dwTCardPanel__carousel，替换原来的dwTPageControl__carousel。因为原来的TabSheet天生有4像素的边距，而且无法消除 
        （10）增加了
        （11）

- 例程
	（1）更新了glogin, 解决了不记住密码无效的bug
        （2）dwQuickCrud 采用了复杂的机制，解决了达梦数据库recsmax不为-1时，自增字段不能自动添值的bug
        （3）解决了dwQuickCrud中日期时间型编辑时日期正确，时间不正确(显示为当前时间)的bug
        （4）修改了dwQuickCrud, 使之新增时保存boolean值
        （5）更新了“driver驾校理论考试”例程，消除了一些bug
        （6）dwQuickCrud增加事件触发：删除弹框前 x=10, 其中主表Y=0， 从表1,2,3,4；删除前 X= 11, 其中主表Y=0， 从表1,,2,3,4；删除后 X=12, 其中主表Y=0， 从表1,2,3,4
        （7）更新了dwDriect.dll类型应用，支持根据参数是否包含"json=1"字符串， 动态输出json格式或非json格式
        （8）***增加了dwCrudPanel模块***，类似原dwQuickCrud。区别于dwCrudPanel的对象是Panel，一个窗体中可以放置多个；dwQuickCrud的对象是TForm, 不能同时放几个。
                 dwCrudPanel的结构更简单，扩展性更强！
        

#### 2024-10-31

- 服务端 DeWebServer
	（1）增加了服务端通过SSE（Server-Sent Events）主动向前端推送数据的功能，详见 Source\demos\SendSSEMsg服务器端主动推送SSE消息
- 控件
	（1）完善了dwTStringGrid__dvscroll控件已更新！当点击相应单元格时， 会自动将StringGrid的col和row设置为当前单元格，并触发OnClick事件
- 例程
	（1）重构了QuickCard功能，可以快速创建移动端增删改查功能，详见 Source\demos\gCard
        （2）重构了dwMobile移动端框架，可以快速创建移动端综合应用
        （3）完成了微信JSAPI支付，源码稍后整理后发到 https://www.delphibbs.com/mall

#### 2024-10-09

- 服务端 DeWebServer
	（1）消除了web页面启动后有一个光标的bug
- 控件
	（1）完善了StringGrid__multi控件，增加了click事件支持，增加了筛选和排序支持，完善了图片显示 
- 例程
	（1）进一步完善了QuickCrudConfig例程，增加了图片类型，支持新增和编辑

#### 2024-09-19

- 服务端 DeWebServer
	（1）实现了浏览器JS向delphi传数据！
	（2）完善了时钟控制机制，完善了多种窗体下多Timer的控制
- 控件
	（1）更新了StringGrid控件，增加了拖动列宽事件，触发OnColumnMoved, 第一个参数的列序号，第二个参数为列宽
	（2）完善了DateTimePicker控件,消除了9月时会自动转为1月的bug
	（3）增加了移动端水平滚动控件dwTPanel__hscroll
- 例程
	（1）进一步完善了QuickCrudConfig例程，增加了筛选，导出Excel等功能

#### 2024-09-08

- 服务端 DeWebServer
	（1）连接达梦数据库成功！
	（2）DWS的FDConnection增加了自动重连
	（3）消除了DWS的gjoConnections.db多出几个的bug


- 控件
	（1）更新了dwTStringGrid__dvcapsule胶囊图控件，增加了例程
	（2）完善了dwTStringGrid__multi, 解决了button列无width的问题。 可能导致水平拖动时上下错行
	（3）增加了翻书效果控件 CardPanel__turn
	（4）增加了控件Label__marquee2，支持超长字符串走马灯效果
	（5）解决了TButton由于需要处理右侧图标，而造成的仅有图标时未居中的问题
	（6）完善了StringGrid, 解决了Cells中有单引号的bug；完善了多选列
	（7）完善了HeaderControl, 使用了每个Section的width，而非原来的平均分
	（8）为HeaderControl增加了dwattr和dwstyle支持
	（9）增加了Panel__OK控件， 可以快速弹出“确定/取消”框
	（10）为dwTStringGrid__multi增加了拖动列宽事件，触发OnColumnMoved, 第一个参数的列序号，第二个参数为列宽

- 例程
	（1）增加了gCrud通用增删改查例程，支持不写代码，生成应用
	（2）增加了QuickCrudConfig例程，用于可视化配置QuickCrud的配置文件
	（3）增加了QuickCrudStat例程，用于嵌入统计单元
	（4）QuickCrud模块全面完善！
		- 字段增加了view属性,用于:全显示/新增编辑显示/全不显示
		- 支持添加多选列，支持一次删除多条记录
		- 增加了dwGetWhere函数，可以取得where
		- 增加了数据更新时的事件， OnDragOver, Y = 5
		- 精简了部分函数名，如 qcGetQuickCrudFDQuery 改为 qcGetFDQuery

#### 2024-08-08

- 完善了DeWebServer.exe
  （1）完善了移动端触发回退事件
  （2）解决了子窗体Name必须是Form开始的问题 

- 完善了dwTButton, 解决了无righticon时动态切换righticon的问题

- 完善了dwTMemo__echarts, 增加了支持onclick事件中取得点击元素信息。 
信息以JSON的形式保存在该TMemo的StyleName中
信息包括：name,data,seriesName,seriesIndex,dataIndex
其中data可能是数值，如224，也可能是对象，如{"value":745,"name":"Direct"}

- 完善了gLogin通用登录模块
 （1） 增加了对captcha=2的处理： 第一次不显示验证码。输错后显示验证码
 （2）在url中除了配置文件，还可以设置successurl，使用方法类似：http://127.0.0.1:8080/glogin?dwFrame&&success=hello
 （3）支持更新logo. 原来的没更新
 （4）支持电脑端时登录框随屏幕缩放自动位置指定比例位置。 原来只随显示器大小变化，而非浏览器

- 完善了dwTStringGrid__multi，增加了表头的对齐方式与内容一致

- 完善了dwTFlowPanel__auto, 使之可以固定列数

- 完善了dwTDBGrid.dpr, 主要是更新了dwCtrlBase.pas, 在dwProcessCaption函数中增加了对#10的处理

- 完善了dwTStringGrid__multi 在column中加入了"wrap":1来控制自动换行，默认不换行

- 更新了dwTTabsheet__timeline.dll, 解决了内置label不能显示的bug

- 解决了预览中文mp3时报错的问题


#### 2024-06-18

- 完善了FlowPanel__auto，增加了对仅有一个不可见子控件时的处理

- 更新了dwAssist，支持更多的控件属性，强烈推荐安装！！！

- 移除了所有代码中的VclTee引用，保证了正常编译运行

#### 2024-04-23

- 增加了免费商用版，可免费用于商业用途。
   限制是只能使用基础控件，不能使用通过HelpKeyword扩展的控件

- 增加了Panel__Cesium控件，可以进行三维地球展示和模拟飞行等

- 增加了Memo__mqtt控件，可以订阅/收发mqtt消息

- 更新了DeWebServer，支持在移动端拦截回退消息（参考例程：source\demos\MobileBase移动端基础）

- 更新了dwFrame， 进一步完善，并加入了部门管理

- 更新了dwQuickCrud, 进一步简化，并给出了生成的控件结构树（“QuickCrud 控件结构.txt”）

- 升级了MSSQL数据库，由2000升级到2008


#### 2024-04-03

- 主力开发平台升级到Delphi 12

- 更新了dwAssist，支持更多的控件属性，强烈推荐安装！！！
- 完善了dwFrame综合管理系统，可以直接用来开发项目（重点！）
   - 提升了多页面打开稳定性
   - 增加了单设备登录（每个用户不允许同时多个用户登录）
   - 增加了系统日志管理
   - 增加了QuickCrud模块，可以通过数据表读取外部文件直接生成QuickCrud模块
   - 增加了大量典型应用模块
   - 
- 完善了combobox，增加了左侧图标
- 完善了通用登录模块glogin，增加了下拉用户功能设置
- 完成了通过DeWeb调用微信扫一扫
- 完善了QuickCard
    - 解决了未设置cardheight报错的bug, 默认为140
    - 增加了对字段align的处理, 解决办法：将配置中的align赋给ListView列的Alignment即可
- 完善了dwTButton和完善了dwTTrackBar__mobile, 主要解决按钮在ios中不居中的bug. 
- 完善了m3u8格式的播放，主要修改了dwTMediaplayer__m3u8，已应用到项目
- 完善了QuickCrud

- 解决了Timer在docksite后多执行1次的bug
- 解决了StringGrid__dvscroll字体设置不成功的bug
- 解决了ElementUI三四级菜单的显示问题
- 解决了dwTShape__menu中的一个笔误（将indent写成index）,并最终去掉了indent,因其导致了界面出错

- 增加了多列下拉框ListView__combo
- 增加了DBGrid/DBLabel/DBEdit/DBComboBox/DBCheck/DBMemo等控件，暂无DBImage
- 增加多类型表格StringGrid__multi,主要是多功能版，可内嵌Check/Edit/Combo/Image/Spin/Date/DateTime/Time/Memo/Switch/Progress/Button等

#### 2024-01-30
-
1 完善了gLogin通用登录模块，解决了报数据库未连接的bug;
2 完善了dwQuickCrud单元，解决了dwRuoYi综合管理系统中的增删改查问题

#### 2024-01-29
-
1 增加了comm串口收发例程
2 增加了ShapeMenu菜单例程
3 增加了Cesium三维地球例程
5 完善了coupon优惠券例程，解决了分页4时显示1的bug
6 完善了dwVcls中的dwTListView__card.dpr, 解决了单独打开时报错的bug
7 完善了gLogin通用登录例程，增加了未连接数据库时相应提示等


#### 2024-01-27
-
1 增加了在线热更新例程HotUpdate
1 增加了dwTButtonGroup_category, 用于完成纵向分类列表
3 增加了dwTrackBar__mobile，用于.移动端分页
4 增加了wmpSystem小程序系列例程，用于小程序功能，支持微信扫一扫
5 增加了TButton__simple,Label__simple等，以及以前的Panel__simple, 用于优化代码；
6 增加了dwSimple函数，用于配合以上控件一键优化代码
7 增加了部分控件使用说明文件(markdown格式)，后面持续更新中
8 完善了dwRuoYi综合例程
  （1）性能优化；
  （2）稳定性更新
9 完善了Listbox，消除了选中时闪动取消的bug.
10 更新了ListViewCrud
12 更新了dwTPanel__button完善了图片和标题显示问题，看起来更加美观
13 完善了QuickCard单元


#### 2023-12-25
-
1 增加了dwRuoyi例程
  (1) 基本和dwFrame差不多，更加完善一些
  (2) 数据库基本采用了RuoYi的基本架构
  (3) 增加了模块数据表sys_module，可以通过数据库记录创建数据库模块
  (4) 模块关闭时可以自动释放
  (5) 准备陆续加入进销存/ERP模块， 研发中

2 更新了coupon优惠券例程！ 采用了数据库方式

3 消除了TListBox选中时闪动取消的bug. 

4 批量消除dwTListView__mobile，dwTListView__card.dpr，dwTDBGrid__crud.dpr等几个控件的id命名错误。

#### 2023-12-09
-
1 更新了DeWebServer.exe, 主要有：
   	(1) 支持oracle数据库。需要在Runtime和Runtime\Apps两个目录中都复制3个oracle库文件oci.dll, oraociei12.dll和oraons.dll。感谢群友“寒酥”
	(2) 完善了对时钟Timer的控制
	(3) 增加了对D12的支持，同时不再支持D10.3.3 

2 完善了dwFrame综合后台管理
  	(1)  默认采用MSSQL
	(2) 集成gLogin
    	(3) 完成用户管理
    	(4) 权限管理
     	(5) 组织机构管理
	(6) 增加了hello,dbhello,QuickCrud等3个示例模块
	(7) 增加了通过外置文件创建QuickCrud模块

3 进一步完善了QuickCrud单元
	(1) 解决了日期格式的数据在新增和编辑时报错的bug
	(2) 增加了对“不排序”的处理，原来对排序字段只有“正向排序”和“反向排序”
	(3) 增加了quickcrud中外部更新功能，即使用其他控件更新QuickCrud显示
      	(4) 加入了自定义事件的支持，统一通过当前Form的OnDragOver事件
	(5) 表格表头支持\n换行，注意：在QuickCrud的JSON中需要使用\\n
	(6) 增加了type为combopair（键-值对）的支持。
	(7) 增加了memo类型支持
	(8) 增加了dbtree类型支持
	(9) 解决了QuickCrud中“新增”时未默认最大化的bug
	(10) 增加了dwCrudDestory函数，以清除crud, 方便二次crud

4 完善了gLogin通用登录管理系统，开发者仅需要修改一个JSON文件即可实现登录管理

5 QuickCard增加了new/edit激活事件
  	保存前激活Form的OnDragDrop事件
  	保存后激活Form的OnDragOver事件

6 完善了dwTreeView
	(1) Enabled
	(2) 节点展开/合拢
	(3) expand-on-click-node和HotTrack绑定

7 更新了dwTEdit.dpr， 主要是在Edit中回车不能更新当前Edit.
原来设置的ParentCustomHint未生效，改成了DoubleBuffered.

8 完成增加了Panel__cesium，支持在页面中增加cesium支持

9 增加了串口收发支持，采用TButton__comm

10 完善了Panel__button. 消除了有hrefself时dwGetTail少一个</a>的bug(感谢网友Aragorn)

11 增加了Panel__float浮动式面板 , 放入TPanel中，拖动它，可以拖动父面板位置

12 解决了群友反映的TButtonGroup__menu菜单闪动关闭的问题。

13 增加Shape__menu, 用TShape+TMainMenu共同完成菜单的工作（同时移除了dwTMainMenu控件）
	其中TShape用于占位和配置，TMainMenu用于事件

14 完善了dwTTimer.dpr, 解决了Timer重新启动后不正常的bug

15 增加了Panel__simple（简化版Panel）可以减少普通 Panel生成的代码量

16 增加了TreeView__grid，目前支持树形表格中嵌入check/button，后续拟加入更多类型

17 完善了StringGrid
  （1）最后一列不设置宽度，直接到表格最右边
  （2）增加了排序时不排序的处理，原来只处理了升序和降序

18 基本完成了Edit__tree, 可以显示树形编辑框

 



#### 2023-09-27
-
1 完善了TMainMenu, 解决了该控件引起的bug;
2 增加了微信公众号和微信小程序开发例程
3 增加了获取地理位置例程；
4 增加了卡片式数据显示例程；
5 更新了QuickCard例程（1）默认显示增删改查；（2）更新UI；
6 完善了DeWebServer，解决了取fullurl和params的中文乱码问题；


#### 2023-09-23
-
1 增加了dwTLabel__marquee控件，可以显示跑马灯效果
2 增加了取当前地理位置例程
3 增加了QuickCard单元，可以快速创建移动端基本数据库模块
4 增加了支持手动更新服务端控件值,并激活事件的功能
5 完善了StringGrid，消除了显示标题不正确的bug
6 完善了TEdit, 支持动态设置ReadOnly
7 完善了TPageControl, 解决了有时页标题未满格的问题 
8 解决了浏览器回退后不能恢复原界面的bug
9 所有例程添加了中文说明和演示图片

#### 2023-08-27
-
1、DeWeb的Config.json文件中数据账套中可以通过增加"enabled":0暂停打开当前账套；
2、新增了几个控件
  （1）TFlowPanel__auto 支持自动重排子控件；
  （2）TImage__preview 支持图片点击预览、缩放等；
  （3）TPanel__selected 支持右下角选择面板；
3、完善了部分控件，包括TTreeView、TListView__mobile等；
4、完善了QuickCrud；
